# 6.3 패키지 번들의 선두주자, 롤업

롤업은 자바스크립트를 비롯한 다양한 리소스 파일을 하나 이상의 번들 파일로 묶는 데 중점을 둔 도구로, 코드 최적화와 효율적인 번들링에 최적화에 특화돼 있습니다.

## 6.3.1 롤업의 등장 배경과 소개

롤업의 등장 배경을 이해하기 위해서는 웹펙의 등장 배경을 먼저 이해해야할 필요가 있습니다.
웹팩은 단일 페이지 애플리케이션을 효과적으로 빌드하기 위해서 탄생했고 이를 위해서 코드 분할 기능과 CSS나 이미지 같은 정적 자원을 의존성 그래프에 포함시킵니다.

그리고 웹팩이 탄생했을 당시인 2012년에는 commonJS가 일반적인 모듈 방식이었기 떄문에 이헤 기반한 단점들도 존재했습니다.

- 느린 자바스크립트 로드 시간
- 트리 셰이킹이 어려움
- 함수로 감싸야하는 모듈로 발생하는 오버헤드

이런 단점들을 해결하고자 기본 모듈을 ESM으로 하는 롤업이 탄생하게 됐습니다.

롤업은 ES6의 ESM으로 가능한 한 자바스크립트 번들을 평탄하게 만드는 목표를 가지고 있었습니다.
그래서 웹팩과 달리 같은 장소에 코드들을 배치해서 하나의 코드 덩어리로 만들어 실행을 간단하게 만들었습니다.

하지만 이런 방식이 장점만 있었던 것은 아닙니다.

대표적으로 코드 분할과 HMR이 어려웠습니다.
위에서 말했듯이 하나의 코드 덩어리로 만들기 때문입니다.

그래서 웹팩과 롤업은 목적에 따라 구분해서 사용하는 것이 중요해졌습니다.
만약 코드 분할과 HMR이 중요한 웹 애플리케이션을 만든다면 웹팩을,
여러 코드를 다른 개발자나 웹서비스에 제공하기위한 라이브러리를 만든다면 롤업을 사용하는 것이 더 적합합니다.

## 6.3.2 롤업의 기본 개념과 특징

롤업은 ESM 기반 모듈 번들링을 제공합니다. 이는 모든 모듈을 평탄화해서 하나의 큰 덩어리로 만들어버려서 모듈의 오버헤드를 최소화합니다.

또, 롤업은 ESM과 CommonJS뿐만 아니라 SystemJS와 AMD같은 다양한 모듈 시스템을 지원합니다.

트리 셰이킹은 롤업의 가장 큰 강점입니다. (이었습니다.) 롤업이 등장했을 당시에는 다른 번들러는 트리 셰이킹을 지원하지 않았기 떄문이죠.
롤업이 트리 셰이킹을 지원할 수 있었던 이유는 ESM과 관련이 있습니다.
동적으로 모듈을 관리하는 commonJS와 달리 ESM은 정적으로 모듈을 관리해서 번들링 하는 시점에 어떤 코드가 사용되지않는지 효과적으로 파악해서 제거할 수 있었습니다.
